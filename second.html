<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Second Collection</title>
</head>
<body>

<h1>Home Collection</h1>

<div class="top-bar">
  <input id="videoUrl" placeholder="Paste URL">
  <input id="videoTitle" placeholder="Video title">
  <br>
  <button onclick="addVideo()">â•</button>
  <button onclick="goSecond()">ğŸ“</button>
</div>

<div class="video-grid" id="videoGrid"></div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbycA_om2I7z35jXUnJdFP50R8r-XySAiJs3D-6pE_olllud8y10QmOJ2DVPcA2hx_el/exec";
const DELETE_PASSWORD = "00000";
const COLLECTION = "Second";

function goSecond() {
  window.location.href = "second.html";
}

async function addVideo() {
  if (!videoUrl.value.trim()) return alert("Paste a URL");
  await fetch(API_URL, {
    method:"POST",
    body:JSON.stringify({
      url:videoUrl.value,
      title:videoTitle.value,
      collection:COLLECTION
    })
  });
  videoUrl.value=""; videoTitle.value="";
  loadVideos();
}

async function deleteVideo(url) {
  if (prompt("Delete password:") !== DELETE_PASSWORD) return;
  await fetch(API_URL,{
    method:"POST",
    body:JSON.stringify({
      action:"delete",
      url,
      collection:COLLECTION
    })
  });
  loadVideos();
}

async function renameTitle(url,title) {
  await fetch(API_URL,{
    method:"POST",
    body:JSON.stringify({
      action:"rename",
      url,
      title,
      collection:COLLECTION
    })
  });
}

async function loadVideos() {
  const res = await fetch(`${API_URL}?collection=${COLLECTION}`);
  const data = await res.json();
  videoGrid.innerHTML="";
  data.reverse().forEach(([url,title])=>{
    videoGrid.innerHTML+=`
      <div class="video-card">
        <iframe src="${url}" allowfullscreen></iframe>
        <div class="title" ondblclick="edit(this,'${url}')">${title}</div>
        <div class="actions">
          <a href="${url}" target="_blank">â–¶ï¸</a>
          <button class="delete-btn" onclick="deleteVideo('${url}')">ğŸ—‘ï¸</button>
        </div>
      </div>`;
  });
}

function edit(el,url){
  const i=document.createElement("input");
  i.value=el.innerText;
  i.className="title-edit";
  el.replaceWith(i);
  i.focus();
  i.onblur=()=>{ renameTitle(url,i.value); loadVideos(); };
}

loadVideos();
</script>
</body>
</html>
